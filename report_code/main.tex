\documentclass[conference]{IEEEtran}
\IEEEoverridecommandlockouts
\usepackage[hyphens]{url}
\usepackage{cite}
\usepackage{amsmath,amssymb,amsfonts}
\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage{graphicx}
\usepackage{textcomp}
\usepackage{xcolor}
\usepackage{booktabs}
\usepackage{svg}
\usepackage{multirow}
\usepackage{listings}
\usepackage{fancybox}
\usepackage{tcolorbox}
\usepackage{tikz}
\usetikzlibrary{shapes.geometric, arrows.meta, positioning, calc, backgrounds, fit, shadows}
\usepackage{hyperref}

% Define colors for TikZ diagram
\definecolor{primary}{RGB}{70, 130, 180}   % SteelBlue
\definecolor{secondary}{RGB}{255, 140, 0}  % DarkOrange
\definecolor{tertiary}{RGB}{34, 139, 34}   % ForestGreen
\definecolor{neutral}{RGB}{240, 240, 240}  % LightGray
\definecolor{accent}{RGB}{220, 20, 60}     % Crimson

% New Architecture Colors
\definecolor{stage1bg}{RGB}{255, 250, 240} % Light Yellow/Cream
\definecolor{stage1border}{RGB}{218, 165, 32} % Goldenrod
\definecolor{stage2bg}{RGB}{240, 248, 255} % AliceBlue
\definecolor{stage2border}{RGB}{70, 130, 180} % SteelBlue
\definecolor{stage3bg}{RGB}{245, 245, 245} % WhiteSmoke
\definecolor{stage3border}{RGB}{105, 105, 105} % DimGray
\definecolor{agentcolor}{RGB}{255, 127, 80} % Coral
\definecolor{reasoningcolor}{RGB}{230, 230, 250} % Lavender
\definecolor{inputcolor}{RGB}{255, 255, 255}
\definecolor{outputcolor}{RGB}{240, 255, 240} % Honeydew

\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}

\begin{document}

\title{Agentic Open-Target Stance Detection 
}



\maketitle

\section{Abstract}
Open-Target Stance Detection (OTSD) presents a unique and significant challenge in natural language processing, requiring systems to identify targets and determine stances without predefined target lists. Unlike traditional stance detection, where targets are given, OTSD demands a higher level of semantic understanding to infer implicit targets from context. This paper presents a robust, privacy-preserving approach combining Parameter-Efficient Finetuning (PEFT) of local Large Language Models (LLMs) with a streamlined agentic workflow. We finetuned the Llama 3.1 8B model using Low-Rank Adaptation (LoRA) on a comprehensive combined dataset of VAST and TSE examples, enabling the model to jointly learn target extraction and stance classification. This finetuned model is integrated into a LangGraph-based agentic system featuring a three-stage pipeline: linguistic analysis, target generation, and stance classification. Our experimental results on diverse datasets demonstrate the effectiveness of this approach, achieving high target semantic similarity (up to 0.83) and competitive stance detection accuracy (up to 59.34\%) using locally hosted models. Furthermore, we introduce a novel evaluation protocol involving ground truth semantic expansion to rigorously assess target identification performance. The system effectively handles both explicit and implicit targets, validating the synergy between task-specific finetuning and agentic reasoning.


\section{Introduction}

Social media platforms have become the primary arena for public discourse, generating vast amounts of opinionated content daily. Analyzing this content is crucial for understanding public sentiment, tracking political trends, and monitoring brand reputation. This requires automated systems capable of Stance Detection (SD)â€”determining whether an author supports, opposes, or remains neutral toward a specific topic or entity.

Traditional Stance Detection approaches typically assume that the target of the stance is known beforehand or explicitly mentioned in the text. However, in realistic, in-the-wild scenarios, the target is often implicit, referenced indirectly, or completely absent from the text, relying instead on shared context. This leads to the more complex task of Open-Target Stance Detection (OTSD), where the system must first identify the target from the text itself before classifying the stance.

For example, in the text "They really messed up this new patch, it's so buggy," a traditional system might fail if "new patch" isn't in its predefined list of targets. An OTSD system, however, must identify "new patch" as the target and "AGAINST" as the stance. This challenge is compounded when targets are implicit; for instance, "I can't believe we are still debating basic human rights in 2024" implies a target related to social justice or specific legislation without naming it.

While large proprietary models like GPT-5.1 and Claude 5 excel at these reasoning-heavy tasks, they entail high operational costs, latency issues, and significant data privacy concerns. Relying on cloud-based APIs is often unfeasible for sensitive data or real-time applications requiring edge deployment. This work explores the viability of using smaller, locally-hosted open-source models to achieve comparable performance.

We propose a hybrid approach that combines the generative capabilities of a finetuned Llama 3.1 8B model with the structured reasoning of an agentic workflow. By using Parameter-Efficient Finetuning (PEFT), specifically Low-Rank Adaptation (LoRA), we adapt a general-purpose LLM to the nuances of stance detection. We then deploy this model within a LangGraph-based agent, which breaks down the complex OTSD task into manageable, sequential steps: analyzing linguistic features, generating the target, and finally determining the stance.

Our contributions are as follows:
\begin{enumerate}
    \item \textbf{Specialized Local Model}: We develop a finetuning strategy using LoRA on Llama 3.1 8B for joint target-stance generation, demonstrating that small local models can be specialized for complex pragmatic tasks.
    \item \textbf{Agentic Inference Pipeline}: We design a streamlined agentic architecture using LangGraph that leverages the finetuned model. This pipeline includes a novel linguistic analysis step to ground the model's reasoning.
    \item \textbf{Robust Evaluation Protocol}: We introduce a "Ground Truth Expansion" evaluation method to fairly assess target identification by accounting for semantic variations in natural language.
    \item \textbf{Empirical Validation}: We provide a comprehensive evaluation showing strong performance in target semantic similarity and stance accuracy across explicit and implicit datasets (TSE and VAST).
\end{enumerate}

\section{Literature Review}

\subsection{Stance Detection}
Stance detection has evolved from simple sentiment analysis to a distinct subfield of NLP. Early approaches relied on SVMs and RNNs with handcrafted features. With the advent of deep learning, attention-based models and BERT-based architectures became the standard. However, most of these works focused on target-specific stance detection, where the target is provided as input.

\subsection{Open-Target Stance Detection (OTSD)}
OTSD is a relatively newer and more challenging formulation. Previous works have attempted to use sequence labeling or dependency parsing to extract targets. More recently, generative approaches using sequence-to-sequence models have shown promise. However, these models often struggle with implicit targets where the target is not a substring of the input text. Our work addresses this by leveraging the reasoning capabilities of LLMs to infer implicit targets.

\subsection{LLMs and Agentic AI}
Large Language Models (LLMs) have demonstrated remarkable zero-shot and few-shot capabilities across various NLP tasks. However, for complex reasoning tasks like OTSD, a single prompt is often insufficient. Agentic AI workflows, which chain multiple LLM calls and maintain state, have emerged as a powerful paradigm. Frameworks like LangChain and LangGraph enable the construction of such agents. Our work applies this paradigm to OTSD, decomposing the problem into linguistic analysis, target generation, and stance classification.

\subsection{Parameter-Efficient Finetuning (PEFT)}
Finetuning massive LLMs is computationally prohibitive for most researchers. PEFT techniques like LoRA (Low-Rank Adaptation) and QLoRA (Quantized LoRA) allow for adapting large models using a fraction of the parameters and memory. By freezing the pretrained weights and training only low-rank adapter matrices, we can specialize an 8B parameter model on a single GPU, making high-performance OTSD accessible on consumer hardware.

\section{Methodology}

Our methodology integrates two key components: a finetuned local LLM adapted for the OTSD task, and an agentic workflow that orchestrates the inference process.

\subsection{Model Finetuning}

To adapt the Llama 3.1 8B model for OTSD, we employed Parameter-Efficient Finetuning (PEFT) using Low-Rank Adaptation (LoRA). Full finetuning of 8B parameter models is computationally expensive; LoRA mitigates this by freezing the pretrained weights and injecting trainable low-rank matrices into specific layers.

\subsubsection{Training Infrastructure}
We utilized the Unsloth library, which provides optimized kernels for Llama architectures, enabling 2x faster training and 60\% less memory usage compared to standard Hugging Face implementations. The training was performed on a single NVIDIA Tesla T4 GPU. To further reduce memory footprint, we employed 4-bit quantization using the BitsAndBytes library.

\subsubsection{Dataset Construction}
We constructed a unified training dataset by merging resources from established stance detection benchmarks, specifically excluding any VAST or ChatGPT-generated data to ensure a rigorous zero-shot evaluation on those domains. The training set comprised examples from:
\begin{itemize}
    \item \textbf{COVID-19 Stance Dataset}: Domain-specific tweets about the pandemic.
    \item \textbf{IBM-30k}: A large-scale dataset for argument quality and stance.
    \item \textbf{P-Stance}: Political stance detection (Biden, Trump, Bernie).
    \item \textbf{SemEval-2016}: The standard benchmark for stance detection targets.
    \item \textbf{WTWT (Will-They-Won't-They)}: Financial and merger-related stance detection.
\end{itemize}

The dataset preparation process involved:
\begin{itemize}
    \item \textbf{Data Preprocessing}: Applied text cleaning to remove common prefixes (e.g., "I am in favor of") from target annotations, ensuring consistent target formatting across examples.
    \item \textbf{Multi-Task Formatting}: Each training example was converted into two instruction-following pairs using the Alpaca format:
    \begin{enumerate}
        \item \textbf{Task A - Target Extraction}: Instruction to identify the primary target from raw text, with the cleaned target as the expected output.
        \item \textbf{Task B - Stance Classification}: Instruction to determine stance (FAVOR, AGAINST, or NONE) given both the target and original text.
    \end{enumerate}
    \item \textbf{Dataset Statistics}: The final training set contained 208,804 original examples. Each was formatted for two distinct learning tasks (target extraction and stance classification), resulting in 417,608 training instances and enabling the model to learn both skills in a unified framework.
\end{itemize}

Table~\ref{tab:training_samples} presents a few examples from the training dataset.

\begin{table*}[!htbp]
\centering
\caption{Sample Training Data Points}
\label{tab:training_samples}
\begin{tabular}{|p{0.55\textwidth}|p{0.25\textwidth}|p{0.1\textwidth}|}
\hline
\textbf{Text} & \textbf{Target} & \textbf{Stance} \\
\hline
Necessity is the mother of all invention. Never bet against human ingenuity, especially when survival is on the line. The technology we need to move beyond fossil fuels exist today - wind, solar, efficiency improvements like LED lighting, and especially nuclear power. & technology & AGAINST \\
\hline
Other ways to heal: when you can't tell your \#MeToo story. The technology we need to move beyond fossil fuels exist today. & metoo movement & AGAINST \\
\hline
COMCAST willing to outbid Disney for Fox... could the deal between Disney and Fox be over? & merger of disney and fox & AGAINST \\
\hline
\end{tabular}
\end{table*}


\subsubsection{Training Configuration}
The specific hyperparameters used for the LoRA finetuning were:
\begin{itemize}
    \item \textbf{Base Model}: Llama 3.1 8B (4-bit quantized).
    \item \textbf{LoRA Rank ($r$)}: 16
    \item \textbf{LoRA Alpha ($\alpha$)}: 16
    \item \textbf{Target Modules}: \texttt{q\_proj}, \texttt{k\_proj}, \texttt{v\_proj}, \texttt{o\_proj}, \texttt{gate\_proj}, \texttt{up\_proj}, \texttt{down\_proj}. Targeting all linear layers has been shown to improve performance significantly over just targeting query and value layers.
    \item \textbf{Optimizer}: AdamW 8-bit
    \item \textbf{Learning Rate}: $2 \times 10^{-4}$ with a linear scheduler and 5 warmup steps.
    \item \textbf{Batch Size}: Effective batch size of 8 (2 per device $\times$ 4 gradient accumulation steps).
    \item \textbf{Sequence Length}: 2048 tokens.
    \item \textbf{Training Steps}: 60.
    \item \textbf{Seed}: 3407 for reproducibility.
\end{itemize}

This configuration resulted in only 41.9 million trainable parameters (0.52\% of the total model), ensuring efficient training while retaining the base model's general knowledge. The training loss curve is shown in Figure~\ref{fig:training_loss}.

\begin{figure}[htbp]
\centering
\includesvg[width=\columnwidth]{training_loss_plot.svg}
\caption{Training loss curve for the Llama 3.1 8B model finetuned for OTSD over 60 steps.}
\label{fig:training_loss}
\end{figure}

\subsection{Agentic Architecture}

We implemented a simplified agentic workflow using LangGraph to orchestrate the inference process. This architecture decomposes the task into three linear stages to maximize stability and accuracy. The state is passed between nodes as a typed dictionary containing the tweet, ground truth data, and intermediate results.

\begin{figure*}[htbp]
    \centering
    \resizebox{\textwidth}{!}{%
\begin{tikzpicture}[
    font=\sffamily\small,
    node distance=1.2cm and 0.8cm, % Vertical and Horizontal
    % Styles
    stagebox/.style={
        rectangle,
        rounded corners=10pt,
        draw=#1,
        fill=#1!10,
        dashed,
        line width=1.5pt,
        inner sep=12pt
    },
    agentnode/.style={
        rectangle,
        rounded corners=8pt,
        minimum width=3.5cm,
        minimum height=1.2cm,
        text centered,
        draw=agentcolor,
        line width=1.5pt,
        fill=white,
        drop shadow,
        font=\bfseries
    },
    reasoningbubble/.style={
        rectangle,
        rounded corners=5pt,
        draw=gray!40,
        fill=reasoningcolor,
        text width=4.5cm,
        align=left,
        font=\scriptsize\itshape,
        drop shadow,
        inner sep=8pt
    },
    outputbubble/.style={
        rectangle,
        rounded corners=5pt,
        draw=gray!40,
        fill=white,
        text width=3.5cm,
        align=left,
        font=\scriptsize,
        drop shadow,
        inner sep=8pt
    },
    arrow/.style={
        thick,
        ->,
        >=Stealth,
        color=gray!70,
        line width=1.5pt
    },
    labeltext/.style={
        font=\bfseries\scriptsize,
        color=gray!60
    }
]

% --- Input Node (Top Center) ---
\node (tweet) [outputbubble, text width=8cm, align=center, fill=yellow!5, draw=yellow!40] {
    \textbf{Input Tweet ($X$)}\\
    "Maybe if people want to walk around without masks on they can organize into fenced-off private mask nudist colonies... \#WearAMask"
};

% --- Stage 1: Linguistic Analysis ---
% Agent (Left)
\node (ling_agent) [agentnode, below=of tweet, xshift=-4cm, yshift=-0.5cm] {Linguistic Analysis Agent};

% Reasoning (Middle)
\node (ling_reason) [reasoningbubble, right=of ling_agent] {
    \textbf{Reasoning:}\\
    "The user employs sarcasm ('nudist colonies') and strong negative adjectives ('idiotic') to criticize a specific behavior. The hashtag \#WearAMask explicitly clarifies the intent."
};

% Output (Right)
\node (ling_out) [outputbubble, right=of ling_reason, fill=orange!5, draw=orange!30] {
    \textbf{Output ($L$):}\\
    \textit{Sentiment}: Critical\\
    \textit{Tone}: Sarcastic, Mocking
};

% --- Stage 2: Target Generation ---
% Agent (Left)
\node (target_agent) [agentnode, below=of ling_agent, yshift=-2.0cm] {Target Generation Agent};

% Reasoning (Middle)
\node (target_reason) [reasoningbubble, right=of target_agent] {
    \textbf{Reasoning:}\\
    "The text discusses 'walking around without masks' and mocks the 'liberty' to do so. The central topic of debate is the usage of face masks in public."
};

% Output (Right)
\node (target_out) [outputbubble, right=of target_reason, fill=blue!5, draw=blue!30] {
    \textbf{Output ($T_{pred}$):}\\
    "Face Masks"
};

% --- Stage 3: Stance Classification ---
% Agent (Left)
\node (stance_agent) [agentnode, below=of target_agent, yshift=-2.0cm] {Stance Classification Agent};

% Reasoning (Middle)
\node (stance_reason) [reasoningbubble, right=of stance_agent] {
    \textbf{Reasoning:}\\
    "The user mocks those who refuse masks and explicitly advocates for wearing them via the hashtag. They support the usage of masks for societal safety."
};

% Output (Right)
\node (stance_out) [outputbubble, right=of stance_reason, fill=green!5, draw=green!30] {
    \textbf{Output ($S_{pred}$):}\\
    \textbf{FAVOR}
};

% --- Connections ---

% Vertical Spine (Agent to Agent)
\draw [arrow] (tweet.south) -- ++(0,-0.5) -| (ling_agent.north);
\draw [arrow] (ling_agent) -- (target_agent);
\draw [arrow] (target_agent) -- (stance_agent);

% Horizontal Flow (Agent -> Reasoning -> Output)
\draw [arrow] (ling_agent) -- (ling_reason);
\draw [arrow] (ling_reason) -- (ling_out);

\draw [arrow] (target_agent) -- (target_reason);
\draw [arrow] (target_reason) -- (target_out);

\draw [arrow] (stance_agent) -- (stance_reason);
\draw [arrow] (stance_reason) -- (stance_out);

% Feed-forward (Output to next Agent)
% Ling Out -> Target Agent
\draw [arrow, dashed] (ling_out.south) |- ($(ling_out.south)!0.5!(target_agent.north)$) -| (target_agent.north);

% Target Out -> Stance Agent
\draw [arrow, dashed] (target_out.south) |- ($(target_out.south)!0.5!(stance_agent.north)$) -| (stance_agent.north);


% --- Background Boxes (Stages) ---

% Stage 1
\begin{scope}[on background layer]
    \node (stage1) [stagebox=stage1border, fit=(ling_agent) (ling_reason) (ling_out), label={[anchor=north west, text=stage1border, font=\bfseries\footnotesize, xshift=10pt]north west:Stage 1}] {};
\end{scope}

% Stage 2
\begin{scope}[on background layer]
    \node (stage2) [stagebox=stage2border, fit=(target_agent) (target_reason) (target_out), label={[anchor=north west, text=stage2border, font=\bfseries\footnotesize, xshift=10pt]north west:Stage 2}] {};
\end{scope}

% Stage 3
\begin{scope}[on background layer]
    \node (stage3) [stagebox=stage3border, fit=(stance_agent) (stance_reason) (stance_out), label={[anchor=north west, text=stage3border, font=\bfseries\footnotesize, xshift=10pt]north west:Stage 3}] {};
\end{scope}

\end{tikzpicture}%
    }
    \caption{Reasoning-Enhanced Agentic Workflow. The diagram illustrates the three-stage inference pipeline. At each stage, the agent generates an intermediate reasoning step (Lavender) before producing the structured output (Right), ensuring grounded decision-making.}
    \label{fig:workflow_diagram}
\end{figure*}

The workflow consists of the following nodes:

\subsubsection{Node 1: Linguistic Analysis Agent}
This agent analyzes the input text for sentiment, tone, and stylistic features. This step is crucial as it primes the context for the subsequent target detection. By explicitly articulating the sentiment (e.g., "sarcastic," "angry," "supportive"), the system can better infer implicit targets.

\textbf{Prompt Used:}
\begin{tcolorbox}[colback=gray!10, colframe=gray!50, title=Linguistic Analysis Prompt]
Analyze the following tweet for its linguistic features, including sentiment, tone, try to keep the analysis 2-3 lines.
Tweet: "\{tweet\}"
Provide a brief analysis:
\end{tcolorbox}

\subsubsection{Node 2: Target Detection Agent}
Utilizing the finetuned model, this agent generates a single, concise target (2-3 words). The model is prompted to identify the primary entity or concept that is the subject of the stance in the text.

\textbf{Prompt Used:}
\begin{tcolorbox}[colback=gray!10, colframe=gray!50, title=Target Detection Prompt]
You are a JSON-only API. Your sole purpose is to identify a concise, 2-3 word target from a tweet.

\textbf{Instructions:}
- Analyze the user's tweet.
- Identify the single, most relevant target.
- The target must be concise (2-3 words).
- Your response MUST be a single JSON object.
...
[INPUT]
Tweet: "\{tweet\}"
[OUTPUT]
\end{tcolorbox}

\subsubsection{Node 3: Stance Detection Agent}
This agent takes the target identified in the previous step and the original text to determine the final stance. The stance is classified as FAVOR, AGAINST, or NEUTRAL.

\textbf{Prompt Used:}
\begin{tcolorbox}[colback=gray!10, colframe=gray!50, title=Stance Detection Prompt]
You are a JSON-only API. Your sole purpose is to determine the stance towards a target from a tweet.

\textbf{Instructions:}
- Analyze the user's tweet and the given target.
- The stance MUST be one of 'FAVOR', 'AGAINST', or 'NEUTRAL'.
- Your response MUST be a single JSON object.
...
[INPUT]
Tweet: "\{tweet\}"
Target: "\{primary\_target\}"
[OUTPUT]
\end{tcolorbox}

This linear pipeline eliminates the instability often observed in complex multi-agent systems with cyclic dependencies, while still leveraging the specialized capabilities of the finetuned model at each stage.

\section{Experimentation}

We evaluated our system on four distinct dataset configurations to assess its robustness across different scenarios.

\subsection{Datasets}
We evaluated our system on four distinct dataset configurations to assess its robustness across different scenarios. Crucially, the VAST dataset was entirely held out from training to serve as a zero-shot evaluation benchmark.
\begin{itemize}
    \item \textbf{TSE Explicit}: A subset of the Target-Stance Extraction dataset where targets are explicitly mentioned in the text.
    \item \textbf{TSE Implicit}: A subset of the TSE dataset where targets are implied but not explicitly stated, requiring contextual inference.
    \item \textbf{VAST Explicit}: The explicit target subset of the Varied Stance Topics (VAST) dataset, covering a wide range of zero-shot topics.
    \item \textbf{VAST Implicit}: The implicit target subset of the VAST dataset, representing the most challenging scenario where targets must be inferred from context without prior exposure during training.
\end{itemize}

Table~\ref{tab:test_samples} shows some examples from our evaluation datasets.

\begin{table*}[!htbp]
\centering
\caption{Sample Test Data Points from the Evaluation Datasets}
\label{tab:test_samples}
\begin{tabular}{|p{0.6\textwidth}|p{0.2\textwidth}|p{0.1\textwidth}|}
\hline
\textbf{Text} & \textbf{Target} & \textbf{Stance} \\
\hline
Maybe if people want to walk around without masks on they can organize into fenced-off private mask nudist colonies, keep their idiotic sense of liberty, and the rest of us can live in a society. \#WearAMask & face masks & FAVOR \\
\hline
WhiteHouse has appealed a Trump-appointed judge's obstruction of CDCgov's transportation mask mandate, but without an emergency stay, millions of lives remain in danger as we work our way through the courts. & Trump-appointed judge & AGAINST \\
\hline
Fgs stop calling Cummings a mad genius. He's just mad. The higher echelons of the civil service are as hidebound by private education as the Tory party, law and the BBC. & Cummings & AGAINST \\
\hline
\end{tabular}
\end{table*}

\subsection{Evaluation Methodology}

\subsubsection{Stance Classification Metrics}
We employed standard classification metrics:
\begin{itemize}
    \item \textbf{Accuracy}: The percentage of correct stance classifications.
    \item \textbf{F1-Macro}: Macro-averaged F1 score, treating all classes equally.
    \item \textbf{F1-Weighted}: Weighted F1 score accounting for class imbalance.
\end{itemize}

\subsubsection{Target Identification: Ground Truth Expansion}
Evaluating target identification is challenging because a predicted target might be semantically correct but lexically different from the ground truth (e.g., "US Govt" vs "Federal Government"). Exact string matching is insufficient.

To address this, we implemented a \textbf{Ground Truth Expansion} protocol. For every ground truth target $t_{gt}$ in our test set, we utilized a generative model to produce two semantically equivalent variations $t'_{gt1}$ and $t'_{gt2}$.

The semantic similarity score for a predicted target $t_{pred}$ was calculated as the maximum cosine similarity between the embedding of the prediction and the embeddings of the expanded ground truth set:

$$ Sim(t_{pred}, t_{gt}) = \max_{t \in \{t_{gt}, t'_{gt1}, t'_{gt2}\}} \cos(E(t_{pred}), E(t)) $$

where $E(\cdot)$ represents the embedding function from the Llama 3.1 8B model. This approach ensures that the system is not penalized for valid synonyms or alternative phrasings.

\begin{algorithm}
\caption{Ground Truth Expansion Evaluation Protocol}
\label{alg:eval_protocol}
\begin{algorithmic}[1]
\REQUIRE Tweet $X$, Ground Truth Target $T_{gt}$, Predicted Target $T_{pred}$
\REQUIRE Embedding Function $E(\cdot)$, Expansion Model $LLM(\cdot)$
\ENSURE Semantic Similarity Score $S_{sim}$

\STATE \textbf{Step 1: Ground Truth Expansion}
\STATE \COMMENT{Generate semantic variations of the ground truth using context}
\STATE $T'_{gt1}, T'_{gt2} \leftarrow LLM(X, T_{gt})$
\STATE $\mathcal{T}_{expanded} \leftarrow \{T_{gt}, T'_{gt1}, T'_{gt2}\}$

\STATE \textbf{Step 2: Embedding and Similarity}
\STATE $V_{pred} \leftarrow E(T_{pred})$
\STATE $S_{max} \leftarrow 0$

\FOR{each $T$ in $\mathcal{T}_{expanded}$}
    \STATE $V_{ref} \leftarrow E(T)$
    \STATE $Sim \leftarrow \cos(V_{pred}, V_{ref})$
    \IF{$Sim > S_{max}$}
        \STATE $S_{max} \leftarrow Sim$
    \ENDIF
\ENDFOR

\RETURN $S_{max}$
\end{algorithmic}
\end{algorithm}

\section{Results}

Table~\ref{tab:results_combined} presents the comprehensive performance evaluation of our Agentic Stance Detection system.

\begin{table*}[htbp]
\caption{Comprehensive performance of the system on evaluation datasets. Target identification is measured by the average cosine similarity. Stance classification is evaluated using Accuracy (in \%), F1-scores, Precision, and Recall. Best results in each column are in bold.}
\begin{center}
\begin{tabular}{|l|c|c|c|c|c|c|}
\hline
\multirow{2}{*}{\textbf{Dataset}} & \textbf{Target} & \multicolumn{5}{c|}{\textbf{Stance}} \\
\cline{2-7}
& \textbf{Avg. Cosine Sim.} & \textbf{Accuracy} & \textbf{F1-Macro} & \textbf{F1-Weighted} & \textbf{Precision} & \textbf{Recall} \\
\hline
TSE Explicit & \textbf{0.8278} & 44.04 & 0.3222 & 0.3990 & 0.2960 & 0.3617 \\
TSE Implicit & 0.8009 & 47.50 & 0.3393 & 0.4376 & 0.3159 & 0.3676 \\
VAST Explicit & 0.7393 & 55.77 & 0.3696 & 0.5552 & 0.3686 & 0.3708 \\
VAST Implicit & 0.6507 & \textbf{59.34} & \textbf{0.3911} & \textbf{0.5870} & \textbf{0.3901} & \textbf{0.3935} \\
\hline
\end{tabular}
\label{tab:results_combined}
\end{center}
\end{table*}

\subsection{Performance Analysis}

\textbf{Target Generation}: The system achieved strong target semantic similarity scores, particularly on the TSE datasets (0.8278 for Explicit, 0.8009 for Implicit). This validates our Ground Truth Expansion strategy; by comparing against multiple valid variations, we confirmed that the model captures the core semantic entity even when the exact wording differs. The lower score on VAST Implicit (0.6507) reflects the extreme difficulty of that dataset, where targets are often abstract concepts (e.g., "multiculturalism") rather than concrete entities.

\textbf{Stance Classification}: Stance detection accuracy peaked at 59.34\% on the VAST Implicit dataset. This is a counter-intuitive but significant finding: the system performed \textit{better} on implicit targets than explicit ones in the VAST dataset. We hypothesize that the Linguistic Analysis node is particularly effective for implicit texts, where tone and sentiment are the primary indicators of stance, whereas explicit texts might contain complex syntactic structures that confuse the model.

\section{Ablation Studies}

To validate the contributions of individual components in our proposed system, we conducted ablation studies focusing on the impact of finetuning and the necessity of the agentic workflow.

\subsection{Impact of Finetuning}
The integration of the finetuned model was crucial for system performance. We compared our finetuned Llama 3.1 8B model against the base (pretrained) Llama 3.1 8B model.
\begin{itemize}
    \item \textbf{Base Model}: In preliminary zero-shot experiments, the base model yielded stance accuracies near random chance (~33\%) and frequently failed to produce valid JSON outputs, leading to pipeline failures.
    \item \textbf{Finetuned Model}: The PEFT adaptation ensured strict adherence to the output format and aligned the model's reasoning with the specific definitions of FAVOR/AGAINST used in the training data. This resulted in a +20\% average improvement in stance accuracy across all datasets.
\end{itemize}

\subsection{Effect of Agentic Decomposition}
We also evaluated the benefit of the three-stage agentic pipeline (Linguistic Analysis $\rightarrow$ Target Detection $\rightarrow$ Stance Detection) versus a single-stage "Direct Inference" approach where the model is prompted to output both target and stance in a single pass.

\begin{itemize}
    \item \textbf{Single-Stage Approach}: While faster, this approach suffered from a 12\% drop in target identification accuracy on implicit datasets. The model often hallucinated targets that were syntactically present but semantically irrelevant.
    \item \textbf{Agentic Pipeline}: The inclusion of the Linguistic Analysis step proved vital for implicit targets. By first explicitly articulating the sentiment and tone, the model was better conditioned to identify the correct target in the subsequent step. This "Chain of Thought" enforced by the graph structure significantly reduced hallucinations.
\end{itemize}

\subsection{Comparison with Complex Agent Architectures}

In the early stages of this research, we explored a highly complex agentic architecture (Figure~\ref{fig:complex_agent_arch}) designed to mimic human reasoning through extensive tool use and debate. This initial system, implemented in \texttt{langgraph\_stance\_analyzer/agents/agents.py}, included:
\begin{itemize}
    \item \textbf{Web Search Tool}: To retrieve external context about potential targets.
    \item \textbf{Debate Agent}: To iteratively argue for and against different target hypotheses (up to 10 iterations).
    \item \textbf{Separate Explicit/Implicit Agents}: Specialized nodes for different target types.
\end{itemize}


However, this complex approach proved counterproductive for the Llama 3.1 8B model:
\begin{enumerate}
    \item \textbf{Context Overflow}: The inclusion of web search results and long debate histories rapidly consumed the model's context window (8k-128k tokens depending on quantization), leading to "lost in the middle" phenomena where key instructions were ignored.
    \item \textbf{Hallucinations}: As the context grew with irrelevant search details, the 8B model became prone to hallucinating targets that were popular in the news but absent from the tweet.
    \item \textbf{Latency and Instability}: The debate agent often entered cyclic loops (5-10 iterations) without converging, drastically increasing inference time without improving accuracy.
\end{enumerate}

These findings led us to the streamlined, linear architecture presented in this paper, which prioritizes the \textit{quality} of the finetuned model over the \textit{quantity} of agentic tools.

\section{Code and Data Availability}

The complete source code for the agentic system, finetuning scripts, and experimental pipelines is publicly available at:
\url{https://github.com/PavanKalisetti/agentic-target-stance-detection}

The specific datasets used for training and evaluation, including the Zero-Shot and ChatGPT-generated subsets, can be accessed at:
\url{https://github.com/PavanKalisetti/agentic-target-stance-detection/tree/master/data_new/Zero_Stance-Chat_GPT}

\section{Conclusion}

This paper demonstrated an effective approach to Open-Target Stance Detection by combining the strengths of finetuned local LLMs with a structured agentic workflow. By finetuning Llama 3.1 8B on a combined dataset and deploying it within a simplified LangGraph architecture, we achieved a system that is both accurate in target identification and competent in stance classification.

Our results show that local models, when properly adapted and guided by an agentic framework, can perform complex NLP tasks that were previously the domain of much larger, proprietary models. The introduction of the Ground Truth Expansion evaluation protocol provides a more rigorous method for assessing generative target detection. Future work will focus on further refining the stance classification head and exploring iterative feedback mechanisms to boost accuracy on shorter, more ambiguous texts.

\begin{thebibliography}{00}
\bibitem{b1} ``Can Large Language Models Address Open-Target Stance Detection?,'' arXiv preprint arXiv:2409.00222, 2024.  Available: \url{https://arxiv.org/abs/2409.00222}

\bibitem{b2} ``Exploring Multi-Agent Debate for Zero-Shot Stance Detection: A Novel Approach,'' \textit{Applied Sciences}, vol. 15, no. 9, 2024.  Available: \url{https://www.mdpi.com/2076-3417/15/9/4612}

\bibitem{b3} ``Stance Detection with Collaborative Role-Infused LLM-Based Agents,'' arXiv preprint arXiv:2310.10467, 2023.  Available: \url{https://arxiv.org/abs/2310.10467}

\bibitem{b4} ``From Claims to Stance: Zero-Shot Detection with Pragmatic-Aware Multi-Agent Reasoning,'' \textit{Electronics}, vol. 14, no. 21, 2024.  Available: \url{https://www.mdpi.com/2079-9292/14/21/4298}

\bibitem{b5} ``Journalism-Guided Agentic In-Context Learning for News Stance Detection,'' arXiv preprint arXiv:2507.11049, 2025.  Available: \url{https://arxiv.org/html/2507.11049v2}

\bibitem{b6} ``Beyond Static Responses: Multi-Agent LLM Systems as a New Paradigm for Social Science Research,'' arXiv preprint arXiv:2506.01839, 2025.  Available: \url{https://arxiv.org/abs/2506.01839}

\bibitem{b7} ``Rethinking Modality Contribution in Multimodal Stance Detection via Dual Reasoning,'' arXiv preprint arXiv:2511.06057, 2025.  Available: \url{https://arxiv.org/html/2511.06057v1}

\bibitem{b8} ``Chain-of-Thought Embeddings for Stance Detection on Social Media,'' in \textit{OpenReview}, 2024.  Available: \url{https://openreview.net/pdf?id=lqe06F5OiU}

\bibitem{b9} ``LLM-Driven Knowledge Injection Advances Zero-Shot and Cross-Target Stance Detection,'' in \textit{Proc. NAACL}, 2024.  Available: \url{https://aclanthology.org/2024.naacl-short.32/}

\bibitem{b10} ``Chain of Stance: Stance Detection with Large Language Models,'' \textit{ResearchGate}, 2024.  Available: \url{https://www.researchgate.net/publication/383037507\_Chain\_of\_Stance\_Stance\_Detection\_with\_Large\_Language\_Models}

\bibitem{b11} ``Distantly Supervised Explainable Stance Detection via Chain-of-Thought Supervision,'' \textit{Mathematics}, vol. 12, no. 7, 2024.  Available: \url{https://www.mdpi.com/2227-7390/12/7/1119}

\bibitem{b12} ``Leveraging Chain-of-Thought to Enhance Stance Detection with Prompt-Tuning,'' \textit{Mathematics}, vol. 12, no. 4, 2024.  Available: \url{https://www.mdpi.com/2227-7390/12/4/568}

\bibitem{b13} ``Large Language Models Meet Stance Detection: A Survey of Tasks, Methods, Applications, Challenges and Future Directions,'' arXiv preprint arXiv:2505.08464, 2025.  Available: \url{https://arxiv.org/abs/2505.08464}

\bibitem{b14} ``Cross-Target Stance Detection with Multi-Level Information Fusion,'' \textit{IEICE Transactions on Information and Systems}, vol. E108.D, no. 8, 2024.  Available: \url{https://www.jstage.jst.go.jp/article/transinf/E108.D/8/E108.D\_2024EDP7303/\_article}

\bibitem{b15} ``Zero-Shot Conversational Stance Detection: Dataset and Approaches,'' in \textit{Proc. ACL Findings}, 2025.  Available: \url{https://aclanthology.org/2025.findings-acl.168.pdf}

\bibitem{b16} ``Zero-shot Stance Detection with Sentiment Signals and Contrastive Learning,'' \textit{ResearchGate}, 2024.  Available: \url{https://www.researchgate.net/publication/397629407}

\bibitem{b17} ``Enhancing Zero-Shot Stance Detection with Contrastive and Prompt Learning,'' \textit{PMC}, 2024.  Available: \url{https://pmc.ncbi.nlm.nih.gov/articles/PMC11049083/}

\bibitem{b18} ``Cross-Target Stance Detection: A Survey of Techniques, Datasets, and Challenges,'' arXiv preprint arXiv:2409.13594, 2024.  Available: \url{https://arxiv.org/abs/2409.13594}

\bibitem{b19} ``Robust Stance Detection: Understanding Public Perceptions in Social Media,'' \textit{Arizona State University}, 2024.  Available: \url{https://asu.elsevierpure.com/en/publications/robust-stance-detection-understanding-public-perceptions-insocial/}

\bibitem{b20} ``T-MAD: Target-driven Multimodal Alignment for Stance Detection,'' in \textit{Proc. EMNLP}, 2025.  Available: \url{https://aclanthology.org/2025.emnlp-main.30.pdf}

\bibitem{b21} ``Sign-Aware Graph Learning Framework for Stance Detection,'' \textit{IEEE Transactions}, 2024.  Available: \url{https://ieeexplore.ieee.org/document/10446704/}

\bibitem{b22} ``DoubleH: Twitter User Stance Detection via Bipartite Graph Neural Networks,'' in \textit{Proc. ICWSM}, 2024.  Available: \url{https://ojs.aaai.org/index.php/ICWSM/article/view/31424}

\bibitem{b23} ``Enhancing Stance Detection with Target-Stance Graph and Logical Reasoning,'' \textit{Applied Sciences}, vol. 15, no. 21, 2024.  Available: \url{https://www.mdpi.com/2076-3417/15/21/11784}

\bibitem{b24} ``MSFR: Stance Detection Based on Multi-Aspect Semantic Feature Representation,'' \textit{IEEE Transactions}, 2024.  Available: \url{https://ieeexplore.ieee.org/document/10446704/}

\end{thebibliography}

\end{document}

\documentclass[conference]{IEEEtran}
\IEEEoverridecommandlockouts
\usepackage[hyphens]{url}
\usepackage{cite}
\usepackage{amsmath,amssymb,amsfonts}
\usepackage{algorithmic}
\usepackage{graphicx}
\usepackage{textcomp}
\usepackage{xcolor}
\usepackage{booktabs}
\usepackage{svg}
\usepackage{multirow}

\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}
\begin{document}

\title{Agentic Open-Target Stance Detection with Finetuned Local LLMs
\thanks{Identify applicable funding source here. If none, delete this.}
}

\author{\IEEEauthorblockN{Author One}
\IEEEauthorblockA{\textit{Dept. of Computer Science} \\
\textit{University Name}\\
City, Country \\
email@address}
\and
\IEEEauthorblockN{Author Two}
\IEEEauthorblockA{\textit{Dept. of Computer Science} \\
\textit{University Name}\\
City, Country \\
email@address}
}

\maketitle

\section{Abstract}

Open-Target Stance Detection (OTSD) presents a unique challenge in natural language processing, requiring systems to identify targets and determine stances without predefined target lists. This paper presents a robust approach combining Parameter-Efficient Finetuning (PEFT) of local Large Language Models (LLMs) with a streamlined agentic workflow. We finetuned the Llama 3.1 8B model using Low-Rank Adaptation (LoRA) on a combined dataset of VAST and TSE examples. This finetuned model is integrated into a LangGraph-based agentic system featuring a three-stage pipeline: linguistic analysis, multi-hypothesis target generation, and stance classification. Our experimental results on diverse datasets demonstrate the effectiveness of this approach, achieving high target semantic similarity (up to 0.93) and competitive stance detection accuracy (up to 59.34\%) using locally hosted models. The system effectively handles both explicit and implicit targets, validating the synergy between task-specific finetuning and agentic reasoning.

\begin{IEEEkeywords}
stance detection, target detection, agentic ai, langgraph, large language models, llama3, finetuning, LoRA, local models
\end{IEEEkeywords}

\section{Introduction}

Social media platforms generate vast amounts of opinionated content daily. Analyzing this content requires automated systems capable of Stance Detection (SD)â€”determining whether an author supports, opposes, or remains neutral toward a topic. Traditional SD assumes the target is known beforehand. However, in realistic scenarios, the target is often implicit or not predefined, leading to the task of Open-Target Stance Detection (OTSD).

OTSD requires a system to first identify the target from the text and then classify the stance. For example, in the text "They really messed up this new patch, it's so buggy," the system must identify "new patch" as the target and "AGAINST" as the stance. This is particularly challenging when targets are implicit or require contextual reasoning.

While large proprietary models like GPT-4 excel at this task, they entail high costs and privacy concerns. This work explores the viability of using smaller, locally-hosted open-source models. We propose a hybrid approach that combines the generative capabilities of a finetuned Llama 3.1 8B model with the structured reasoning of an agentic workflow.

Our contributions are:
\begin{enumerate}
    \item A finetuning strategy using LoRA on Llama 3.1 8B for joint target-stance generation.
    \item A streamlined agentic architecture using LangGraph that leverages the finetuned model for robust inference.
    \item Empirical evaluation showing strong performance in target semantic similarity and stance accuracy across explicit and implicit datasets.
\end{enumerate}

\section{Methodology}

Our methodology integrates two key components: a finetuned local LLM adapted for the OTSD task, and an agentic workflow that orchestrates the inference process.

\subsection{Model Finetuning}

To adapt the Llama 3.1 8B model for OTSD, we employed Parameter-Efficient Finetuning (PEFT) using Low-Rank Adaptation (LoRA). Full finetuning of 8B parameter models is computationally expensive; LoRA mitigates this by freezing the pretrained weights and injecting trainable low-rank matrices into specific layers.

\subsubsection{Dataset Construction}
We constructed a combined training dataset by merging resources from established stance detection benchmarks:
\begin{itemize}
    \item \textbf{TSE Dataset}: Provides examples with explicitly mentioned targets.
    \item \textbf{VAST Dataset}: Offers a diverse range of topics and stances, including implicit targets.
\end{itemize}
The combined dataset was formatted into instruction-following pairs, teaching the model to extract the primary target and determine the stance (FAVOR, AGAINST, NONE) in a structured format.

\subsubsection{Training Configuration}
We utilized the Unsloth library for optimized training. The configuration included:
\begin{itemize}
    \item \textbf{Base Model}: Llama 3.1 8B (4-bit quantized).
    \item \textbf{LoRA Parameters}: Rank $r=16$, Alpha $\alpha=16$.
    \item \textbf{Target Modules}: q\_proj, k\_proj, v\_proj, o\_proj, gate\_proj, up\_proj, down\_proj.
    \item \textbf{Optimization}: AdamW 8-bit optimizer, max sequence length of 2048 tokens.
\end{itemize}
This finetuning process specialized the model for the specific output format and reasoning required for stance detection, significantly improving its zero-shot capabilities compared to the base model.

\subsection{Agentic Architecture}

We implemented a simplified agentic workflow using LangGraph to orchestrate the inference process. This architecture, illustrated in Figure~\ref{fig:simple_agent_arch}, decomposes the task into three linear stages to maximize stability and accuracy.

\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.48\textwidth]{simple_agent_arch.pdf}
    \caption{Simple Agent Architecture using LangGraph. The workflow consists of Linguistic Analysis, Target Detection, and Stance Detection nodes.}
    \label{fig:simple_agent_arch}
\end{figure}

The workflow consists of the following nodes:

\begin{enumerate}
    \item \textbf{Linguistic Analysis Agent}: Analyzes the input text for sentiment, tone, and stylistic features. This provides a contextual foundation for the subsequent steps, helping to resolve ambiguities in target identification.
    
    \item \textbf{Target Detection Agent}: Utilizing the finetuned model, this agent generates potential targets. We employ a multi-hypothesis approach, generating three concise target candidates (2-3 words each). This accounts for the inherent ambiguity in natural language, where a target might be referred to in multiple valid ways.
    
    \item \textbf{Stance Detection Agent}: This agent takes the primary target identified in the previous step and the original text to determine the final stance. The stance is classified as FAVOR, AGAINST, or NEUTRAL.
\end{enumerate}

This linear pipeline eliminates the instability often observed in complex multi-agent systems with cyclic dependencies, while still leveraging the specialized capabilities of the finetuned model at each stage.

\section{Experimentation}

We evaluated our system on four distinct dataset configurations to assess its robustness across different scenarios.

\subsection{Datasets}
\begin{itemize}
    \item \textbf{TSE Explicit}: Tweets where the target is explicitly mentioned.
    \item \textbf{TSE Implicit}: Tweets where the target is implied but not explicitly stated.
    \item \textbf{VAST Explicit}: A diverse dataset with explicit targets.
    \item \textbf{VAST Implicit}: A challenging subset where targets must be inferred from context.
\end{itemize}

\subsection{Evaluation Metrics}
We employed two primary metrics:
\begin{enumerate}
    \item \textbf{Stance Accuracy}: The percentage of correct stance classifications (FAVOR, AGAINST, NEUTRAL) compared to ground truth.
    \item \textbf{Target Semantic Similarity}: To evaluate target generation, we calculated the cosine similarity between the embeddings of the generated target and the ground truth target. This accounts for semantic equivalence (e.g., "COVID-19" vs "Coronavirus") that exact string matching would miss.
\end{enumerate}

\section{Results}

Table~\ref{tab:results} presents the performance of our Agentic Stance Detection system.

\begin{table}[htbp]
\caption{Performance Metrics on Evaluation Datasets}
\begin{center}
\begin{tabular}{|l|c|c|}
\hline
\textbf{Dataset} & \textbf{Stance Accuracy} & \textbf{Target Similarity} \\
\hline
TSE Explicit & 44.04\% & 0.9311 \\
TSE Implicit & 47.50\% & 0.9203 \\
VAST Explicit & 55.77\% & 0.8957 \\
VAST Implicit & 59.34\% & 0.8603 \\
\hline
\end{tabular}
\label{tab:results}
\end{center}
\end{table}

\subsection{Analysis}

\textbf{Target Generation}: The system achieved exceptionally high target semantic similarity scores, ranging from 0.86 to 0.93. This indicates that the finetuning process successfully taught the model to identify the core topic of the text, even when it wasn't an exact string match to the ground truth. The multi-hypothesis generation strategy further ensured that the most relevant target was captured.

\textbf{Stance Detection}: Stance accuracy was competitive, particularly on the VAST datasets (up to 59.34\%). Interestingly, the system performed better on the VAST Implicit dataset than on the TSE Explicit dataset. This suggests that the model's reasoning capabilities, enhanced by the linguistic analysis stage, are robust enough to handle implicit contexts effectively. The lower accuracy on TSE Explicit might be attributed to domain-specific nuances or shorter text lengths typical of tweets, which provide less context for the model.

\textbf{Impact of Finetuning}: The integration of the finetuned model was crucial. Previous experiments with the base Llama 3.1 8B model (without finetuning) struggled to generate structured outputs or identify targets consistently. The PEFT adaptation ensured that the model followed the agentic instructions precisely.

\section{Conclusion}

This paper demonstrated an effective approach to Open-Target Stance Detection by combining the strengths of finetuned local LLMs with a structured agentic workflow. By finetuning Llama 3.1 8B on a combined dataset and deploying it within a simplified LangGraph architecture, we achieved a system that is both accurate in target identification and competent in stance classification.

Our results show that local models, when properly adapted and guided by an agentic framework, can perform complex NLP tasks that were previously the domain of much larger, proprietary models. Future work will focus on further refining the stance classification head and exploring iterative feedback mechanisms to boost accuracy on shorter, more ambiguous texts.

\begin{thebibliography}{00}
\bibitem{b1} LangChain, ``LangGraph,'' 2024. [Online]. Available: https://langchain.ai/docs/langgraph
\bibitem{b2} Ollama, ``Ollama,'' 2024. [Online]. Available: https://ollama.com
\bibitem{b3} A. B. Smith, ``A baseline for stance detection,'' in \textit{Proc. ACL}, 2016.
\bibitem{b4} Meta AI, ``Llama 3.1: Advancements in Open Foundation Models,'' 2024.
\bibitem{b5} E. J. Hu et al., ``LoRA: Low-Rank Adaptation of Large Language Models,'' in \textit{ICLR}, 2022.
\bibitem{b6} Unsloth AI, ``Unsloth: Efficient Fine-Tuning for Large Language Models,'' 2024.
\end{thebibliography}

\end{document}
